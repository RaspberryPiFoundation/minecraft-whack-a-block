<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    <h1 id="minecraft-whack-a-block">Minecraft Whack A Block</h1>

<p>Minecraft is one fo the World’s most popular open-world building games.
A free version of Minecraft is available for the Raspberry Pi; it also comes with a programming interface. This means you can write commands and scripts in Python code to build things in the game automatically. It’s a great way to learn Python!</p>

<h2 id="whack-a-block">Whack-a-Block</h2>

<p>The game you are going to create is called “Whack-a-Block”, inspired by the original arcade game <a href="http://en.wikipedia.org/wiki/Whac-A-Mole">“Whac-a-Mole”</a>. The objective of the game is to whack (or hit with a sword) the blocks that light up as glowstone, and turn them back to stone. You will earn points for each block you turn back to stone and the game is over when all the blocks have been turned into glowstone.</p>

<p><img src="images/minecraft-whac-a-block.png" alt="Minecraft Whack-a-Block" /></p>

<p>To create this game you’re going to need to use Minecraft Pi Edition on the Raspberry Pi, and the Python 3 programming environment IDLE.</p>

<p>[[[idle-opening]]]</p>

<p>[[[minecraft-opening]]]</p>

<p>[[[minecraft-testing]]]</p>

<h2 id="build-a-whack-a-block-game-board">Build a Whack-A-Block game board</h2>

<p>You can now begin creating your game. You can start with a fresh new Python script. Save it as <code>whack_a_block.py</code></p>

<p>To begin with you’re going to need to know Steve’s position in the game. If you don’t know how to do this, then you can use the section below, or skip forward if you already know how to do this.</p>

<p>[[[minecraft-steves-position]]]</p>

<ol>
  <li>
    <p>Start by importing the required modules.</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="keyword">from</span> <span class="include">mcpi.minecraft</span> <span class="keyword">import</span> <span class="include">Minecraft</span>
<span class="keyword">from</span> <span class="include">random</span> <span class="keyword">import</span> <span class="include">randint</span>
<span class="keyword">from</span> <span class="include">time</span> <span class="keyword">import</span> <span class="include">sleep</span>
</pre></div>
</div>
    </div>
  </li>
</ol>

<ul>
  <li><code>Minecraft</code> is needed to interact with Minecraft: Pi Edition</li>
  <li><code>randint</code> is used to create random intgerst (whole numbers)</li>
  <li><code>sleep</code> is used to put delays into your program</li>
</ul>

<ol>
  <li>
    <p>Then below your imports you can create a connection to Minecraft: Pi Edition.</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>mc = Minecraft.create()
</pre></div>
</div>
    </div>
  </li>
  <li>
    <p>The next step is to create the game board; this consists of 3x3 stone blocks, which will randomly turn into glowstone and light up.</p>
  </li>
</ol>

<h3 id="challenge">Challenge</h3>

<p>The game board needs to be created just in front of the player, so the first step is to get the player’s <em>tile</em> position and save it as a variable. Call the variable <code>pos</code>.</p>

<h3 class="hint-heading" id="hint-1">Hint 1</h3>
<p class="hint-content hint-1">Have a read through the <strong>Finding Steve’s Position in Minecraft</strong> section for a refresher on how to do this.</p>

<h3 class="hint-heading" id="hint-2">Hint 2</h3>
<p class="hint-content hint-2">The method you need for fetching the player’s tile position is <code>mc.player.getTilePos()</code></p>

<h3 class="hint-heading" id="hint-3">Hint 3</h3>
<p class="hint-content hint-3">Have a look at this image and see if it any help to you.
To save the position of Steve as a variable, you can use the line <code>pos = mc.player.getTilePos()</code></p>

<h3 class="hint-heading" id="hint-4">Hint 4</h3>
<p>Have a look at this video showing you how to save the players positon.</p>

<h2 class="hint-content hint-4" id="setting-your-blocks-near-the-player">Setting your blocks near the player</h2>

<p>The gameboard for Whack-a-block will be a 3x3 grid of blocks. These will need to be placed close to Steve’s position.</p>

<p>Use the section below to learn how to set multiple blocks in Minecraft using Python and skip to the next section if you already know how to do this.</p>

<p>[[[minecraft-setting-blocks]]]</p>

<h3 id="challenge-1">Challenge</h3>

<p>You now have all the skills and knowledge you need to create your game board. You need to create a 3 x 3 block of stone, somewhere close to your player’s position. It should look something like this:</p>

<p><img src="images/board.png" alt="gameboard" /></p>

<h3 class="hint-heading" id="hint-5">Hint 1</h3>
<p class="hint-content hint-5">Try the following steps:<br />
1. Get Steve’s position<br />
2. Set some stone blocks so that they are 3 spaces away from Steve, and at the same height as him. The miidle blocks should be facing Steve directly.</p>

<h3 class="hint-heading" id="hint-6">Hint 2</h3>
<p class="hint-content hint-6">Here are the coordinates you’ll need to set the blocks.<br />
1. Steve’s position -1 on the <code>x</code> to Steve’s position + 1 on the <code>x</code><br />
2. Steve’s position on the <code>y</code> to Steve’s position + 2 on the <code>y</code><br />
3. Steve’s position + 3 on the <code>z</code> to Steve’s position + 3 on the <code>z</code></p>

<h3 class="hint-heading" id="hint-7">Hint 3</h3>
<p class="hint-content hint-7">Here’s the positions as they would appear in Python<br />
~~~ python
pos.x - 1, pos.y, pos.z + 3,
pos.x + 1, pos.y + 2, pos.z + 3,
1
~~~</p>

<h3 class="hint-heading" id="hint-8">Hint 4</h3>
<p>Have a look at this video showing you how to save the players positon.</p>

<h2 class="hint-content hint-8" id="getting-the-player-ready">Getting the player ready</h2>

<p>Now that you have a gameboard for the player to use, you need to create the logic for the game itself.</p>

<ol>
  <li>
    <p>To give the player a warning that the game is about to start, post a couple of messages to the chat window and put a delay into the program using <code>sleep(seconds)</code>. The following code can be placed into your program after the initial gameboard has been created.</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>mc.postToChat(<span class="string"><span class="delimiter">&quot;</span><span class="content">Get ready ...</span><span class="delimiter">&quot;</span></span>)
sleep(<span class="integer">2</span>)
mc.postToChat(<span class="string"><span class="delimiter">&quot;</span><span class="content">Go</span><span class="delimiter">&quot;</span></span>)
</pre></div>
</div>
    </div>
  </li>
  <li>
    <p>Run the program again. You should see the game board appear directly in front of the player, and the messages “Get ready …” and “Go”.</p>
  </li>
</ol>

<h2 id="turn-the-blocks-on">Turn the blocks on</h2>

<p>To begin the next part of the program, you’ll need to create two new variables and set them both to the value of <code>0</code>. <code>blocksLit</code> stores the number of blocks that have been “lit-up”. <code>points</code> will store the number of blocks that the player has managed to hit.</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>blocksLit = <span class="integer">0</span>
points = <span class="integer">0</span>
</pre></div>
</div>
</div>

<p>You now need to write your main game loop. To start off with, you’ll need to know a little bit about how you can generate random numbers in Python. Skip down to the section below, if you are already familiar with this.</p>

<p>[[[python-random]]]</p>

<h3 id="challenge-2">Challenge</h3>

<ol>
  <li>
    <p>Your program will need to loop until the game is over, or in this case until all the blocks are lit.</p>

    <p>Create a <code>while</code> loop which will continue until the <code>blocksLit</code> variable is 9 (i.e. all the blocks are turned to glowstone). Next, put a small delay of 0.2 seconds into the program; otherwise it will run so fast, you won’t be able to whack any blocks!</p>

    <p>From now on, the code will be indented under this <code>while</code> loop.</p>
  </li>
  <li>
    <p>The next step is to randomly turn a block into glowstone. This is more difficult than it sounds: what happens if the block you randomly choose is already glowstone? Your code needs to be able to deal with this.</p>

    <p>The method you will use is a really simple one. The code creates a random position, checks to see if that block is stone, and if it isn’t (i.e. it’s glowstone), it tries again and creates a new random position. The code will continue to do this until it finds a block which is still unlit.</p>

    <p>Create a variable called <code>lightCreated</code> then set it to <code>False</code>; next, create a <code>while</code> loop which will continue until <code>lightCreated</code> is set to <code>True</code>. You should also increase the number of <code>blocksLit</code> by 1, to show that another block will be lit:</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>    blocksLit = blocksLit + <span class="integer">1</span>
    lightCreated = <span class="predefined-constant">False</span>
    <span class="keyword">while</span> <span class="keyword">not</span> lightCreated:
</pre></div>
</div>
    </div>

    <p>Once a block is successfully turned to glowstone, <code>lightCreated</code> will be set to <code>True</code> and the loop will exit.</p>
  </li>
  <li>
    <p>Inside this loop use <code>randint(start, end)</code> to create a random <code>x</code> (between -1 and 1) and <code>y</code> (between 0 and 2) position on the game board:</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>        xPos = pos.x + randint(-<span class="integer">1</span>,<span class="integer">1</span>)
        yPos = pos.y + randint(<span class="integer">0</span>,<span class="integer">2</span>)
        zPos = pos.z + <span class="integer">3</span>
</pre></div>
</div>
    </div>

    <p><img src="images/minecraft-random-block.png" alt="A random block lit up" /></p>
  </li>
  <li>
    <p>Use <code>getBlock(x,y,z)</code> and an <code>if</code> statement to check if the block at the random position is STONE. If it is, set it to glowstone using <code>setBlock(x,y,z,blockId)</code> and make <code>lightCreated = True</code>; if this is not changed, the code will go back to the start of the loop and find another random position.</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>        <span class="keyword">if</span> mc.getBlock(xPos, yPos, zPos) == <span class="integer">1</span>:
            mc.setBlock(xPos, yPos, zPos, <span class="integer">89</span>)
            lightCreated = <span class="predefined-constant">True</span>
</pre></div>
</div>
    </div>

    <p><strong>Note</strong>: Rather than using the ID numbers of blocks (e.g. stone = 1, glowstone = 89), you can use the <code>block</code> module, which holds all the block IDs and their names (e.g. <code>1</code>).</p>
  </li>
  <li>
    <p>Run the program by clicking <code>Run &gt; Run Module</code> in IDLE or by pressing F5; you should see the game board appear. The stone blocks should then, one by one, turn into glowstone and the program should end when all nine are lit.</p>
  </li>
</ol>

<h2 id="whack-blocks">Whack blocks</h2>

<p>The player will whack blocks by hitting them (right-clicking) while holding a sword. The Minecraft API has functions which allow you to find out what blocks were hit; these are known as block hit <em>events</em>. Using the function <code>events.pollBlockHits()</code> you can get a list of the events that have occurred since it was last called, such as blocks which were hit.</p>

<p>You will use events to find out the position of the block which was hit, before using <code>getBlock(x,y,z)</code> to see if the block hit was glowstone. If it was, you will then use <code>setBlock(x,y,z,blockId)</code> to turn it back to stone, before reducing the number of blocks lit and increasing the player’s score.</p>

<ol>
  <li>
    <p>Indented under the <code>while blocksLit &lt; 9</code> loop, create the following code to loop through the block hit events list:</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>    <span class="keyword">for</span> hitBlock <span class="keyword">in</span> mc.events.pollBlockHits():
</pre></div>
</div>
    </div>

    <p><strong>Note</strong>: The <code>hitBlock</code> variable holds the <em>event</em> which has happened. It contains lots of information, including which block was hit, what face was hit and who hit it. You can see this information in the Python shell by using <code>print hitBlock</code>.</p>
  </li>
  <li>
    <p>Use <code>getBlock(x,y,z)</code>, the <code>hitBlock</code> event data and an <code>if</code> statement to see if the block hit was glowstone. If it was, use <code>setBlock(x,y,z,blockId)</code> to set it back to stone before reducing the <code>blocksLit</code> variable and adding 1 to the player’s <code>points</code>:</p>

    <div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>        <span class="keyword">if</span> mc.getBlock(hitBlock.pos.x, hitBlock.pos.y, hitBlock.pos.z) == <span class="integer">89</span>:
            mc.setBlock(hitBlock.pos.x, hitBlock.pos.y, hitBlock.pos.z, <span class="integer">1</span>)
            blocksLit = blocksLit - <span class="integer">1</span>
            points = points + <span class="integer">1</span> 
</pre></div>
</div>
    </div>
  </li>
  <li>
    <p>Run the program. The game board should appear and this time when the blocks are lit, if you hit them by right-clicking with a sword, they should turn off.</p>
  </li>
</ol>

<h2 id="game-over">Game over</h2>

<p>The last step in the game is to let the player know it’s “Game Over” and to tell them how many points they scored. The very last line of the program should be:</p>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre>mc.postToChat(<span class="string"><span class="delimiter">&quot;</span><span class="content">Game Over - points = </span><span class="delimiter">&quot;</span></span> + <span class="predefined">str</span>(points))
</pre></div>
</div>
</div>

<p><img src="images/minecraft-game-over.png" alt="Game over" /></p>

  </body>
</html>
